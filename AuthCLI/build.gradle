/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

plugins {
    id 'org.jetbrains.kotlin.jvm'
    id 'com.github.johnrengelman.shadow' version '5.2.0'
    id 'jacoco'
    id 'org.jmailen.kotlinter'
    id 'io.gitlab.arturbosch.detekt'
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"

    implementation "org.flywaydb:flyway-core:6.3.3"
    implementation "org.jetbrains.kotlinx:kotlinx-cli:0.2.1"
    implementation "org.apache.logging.log4j:log4j-api:2.13.1"
    implementation "org.apache.logging.log4j:log4j-core:2.13.1"

    implementation "com.h2database:h2:1.4.200"

    testImplementation "org.jetbrains.kotlin:kotlin-test"
    testImplementation "org.spekframework.spek2:spek-dsl-jvm:latest.release"
    testRuntimeOnly "org.spekframework.spek2:spek-runner-junit5:latest.release"
    testRuntimeOnly "org.jetbrains.kotlin:kotlin-reflect:latest.release"

    testImplementation 'org.mockito:mockito-inline:latest.release'
    testImplementation 'org.mockito:mockito-core:latest.release'

    implementation 'com.google.inject:guice:4.2.3'
    implementation 'com.google.code.gson:gson:2.8.6'
}

jar {
    manifest {
        attributes 'Main-Class': 'com.kafedra.aaapp.MainKt'
        attributes 'Multi-Release': 'true'
    }
}

shadowJar {
    classifier = ''
    destinationDir = file("$rootDir")
}

test {
    useJUnitPlatform {
        includeEngines 'spek2'
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
        html.enabled true
    }
}

kotlinter {
    reporters = ['html']
    disabledRules = ["no-wildcard-imports"]
}

detekt {
    config = files("$rootDir/detekt.yml")
    buildUponDefaultConfig = true
}